var books=[{title:"The Colour of Magic",cover:"images/covers/Cover_The_Colour_Of_Magic.jpg",links:{amazon:"http://www.amazon.co.uk/dp/0552124753"},characters:["Bel-Shamharoth","Hrun, the Barbarian","Liessa Wyrmbidder","the Luggage","Rincewind","Twoflower"],locations:["Agatean Empire","Ankh-Morpork","Chirm","Dunmanifestin","Krull","Wyrmberg"]},{title:"The Light Fantastic",cover:"images/covers/Cover_The_Light_Fantastic.jpg",links:{amazon:"http://www.amazon.co.uk/dp/055216660X"},characters:["Conan","Ymper Trymon","the Luggage","Rincewind","Twoflower"],locations:["Ankh-Morpork","Unseen University","Death's Domain","Dungeon Dimensions","Vortex Plains","Krull","Trollbone Mountains"]},{title:"Equal Rites",cover:"images/covers/Equal_Rites.jpg",links:{amazon:"http://www.amazon.co.uk/dp/0552166618"},characters:["Granny Weatherwax","Eskarina Smith","Simon","Drum Billet","Archchancellor Cutangle"],locations:["Ramtop Mountains","Ankh-Morpork","Unseen University","River Ankh"]},{title:"Mort",cover:"images/covers/Cover_Mort.jpg",links:{amazon:"http://www.amazon.co.uk/dp/0552166626"},characters:["Death","Mort","Ysabell","Binky","Albert","Keli"],locations:["Death's Domain","Ramtops","Ankh-Morpork","Sto Lat","Patrician's Palace"]}];!function(a){"use strict";var o=a("#book_list"),e=a("#character"),n=a("#location"),t=[],i=[];a.each(books,function(e,n){n.serializedCharacters=JSON.stringify(this.characters),n.serializedLocations=JSON.stringify(this.locations),o.append(Discworld.templates.book(n)),a.each(n.characters,function(a,o){-1===t.indexOf(o)&&t.push(o)}),a.each(n.locations,function(a,o){-1===i.indexOf(o)&&i.push(o)})});var r=o.find("img"),s=new imagesLoaded(r.get());s.on("always",function(){o.shuffle({itemSelector:".book"})});var c=function(){var a=e.val(),t=n.val();console.log([a,t]),o.shuffle("shuffle",function(o){return!("All"!==a&&-1===o.data("characters").indexOf(a)||"All"!==t&&-1===o.data("locations").indexOf(t))})};t.sort(),a.each(t,function(o,n){e.append(a("<option></option>").attr("value",n).text(n))}),e.on("change",c),i.sort(),a.each(i,function(o,e){n.append(a("<option></option>").attr("value",e).text(e))}),n.on("change",c)}(jQuery);